

SELECT count(hc.INCIDENT_ID) count, 
 
  bd.BIAS_DESC
FROM hate_crime2 hc
JOIN bias_desc bd 
    ON hc.INCIDENT_ID = bd.INCIDENT_ID
GROUP BY bd.BIAS_DESC


SELECT count(hc.INCIDENT_ID) count, 
 
  of.OFFENSE_NAME
FROM hate_crime2 hc

JOIN offense_name of 
    ON hc.INCIDENT_ID = of.INCIDENT_ID
GROUP BY of.OFFENSE_NAME;

SELECT count(hc.INCIDENT_ID) count,
 hc.STATE_NAME
  
FROM hate_crime2 hc


GROUP BY hc.STATE_NAME
ORDER BY count DESC;

SELECT count(hc.INCIDENT_ID) count, 
  offense_name.OFFENSE_NAME
FROM hate_crime2 hc
JOIN offense_name  
    ON hc.INCIDENT_ID = offense_name.INCIDENT_ID
GROUP BY offense_name.OFFENSE_NAME
ORDER BY count DESC;

"""
SELECT hc.INCIDENT_ID, 
  hc.INCIDENT_NO,
  hc.DATA_YEAR,
  hc.ORI,
  hc.PUB_AGENCY_NAME,
  hc.PUB_AGENCY_UNIT,
  hc.AGENCY_TYPE_NAME,
  hc.STATE_ABBR,
  hc.STATE_NAME,
  hc.DIVISION_NAME,
  hc.REGION_NAME,
  hc.POPULATION_GROUP_CODE,
  hc.POPULATION_GROUP_DESC,
  hc.INCIDENT_DATE,
  hc.ADULT_VICTIM_COUNT,
  hc.JUVENILE_VICTIM_COUNT, 
  hc.TOTAL_OFFENDER_COUNT,
  hc.ADULT_OFFENDER_COUNT,
  hc.JUVENILE_OFFENDER_COUNT,
  hc.OFFENDER_RACE,
  hc.OFFENDER_ETHNICITY,
  hc.VICTIM_COUNT,
  hc.TOTAL_INDIVIDUAL_VICTIMS,
  hc.VICTIM_TYPES,
  hc.MULTIPLE_OFFENSE,
  hc.MULTIPLE_BIAS,
  hc.INCI_DT_CLEAN,
  bd.BIAS_DESC,
  ln.LOCATION_NAME,
  of.OFFENSE_NAME,
  vt.VICTIM_TYPES
  """
temp_table_sql = """CREATE TEMPORARY TABLE temp_table
SELECT hc.INCIDENT_ID, 
  hc.INCIDENT_NO,
  hc.DATA_YEAR,
  hc.ORI,
  hc.PUB_AGENCY_NAME,
  hc.PUB_AGENCY_UNIT,
  hc.AGENCY_TYPE_NAME,
  hc.STATE_ABBR,
  hc.STATE_NAME,
  hc.DIVISION_NAME,
  hc.REGION_NAME,
  hc.POPULATION_GROUP_CODE,
  hc.POPULATION_GROUP_DESC,
  hc.INCIDENT_DATE,
  hc.ADULT_VICTIM_COUNT,
  hc.JUVENILE_VICTIM_COUNT, 
  hc.TOTAL_OFFENDER_COUNT,
  hc.ADULT_OFFENDER_COUNT,
  hc.JUVENILE_OFFENDER_COUNT,
  hc.OFFENDER_RACE,
  hc.OFFENDER_ETHNICITY,
  hc.VICTIM_COUNT,
  hc.TOTAL_INDIVIDUAL_VICTIMS,
  hc.VICTIM_TYPES,
  hc.MULTIPLE_OFFENSE,
  hc.MULTIPLE_BIAS,
  hc.INCI_DT_CLEAN,
  bd.BIAS_DESC,
  ln.LOCATION_NAME,
  of.OFFENSE_NAME,
  vt.VICTIM_TYPES
FROM hate_crime2 hc
JOIN bias_desc bd 
    ON hc.INCIDENT_ID = bd.INCIDENT_ID
JOIN location_name ln 
    ON hc.INCIDENT_ID = ln.INCIDENT_ID
JOIN offense_name of 
    ON hc.INCIDENT_ID = of.INCIDENT_ID
JOIN victim_types vt 
    ON hc.INCIDENT_ID = vt.INCIDENT_ID;